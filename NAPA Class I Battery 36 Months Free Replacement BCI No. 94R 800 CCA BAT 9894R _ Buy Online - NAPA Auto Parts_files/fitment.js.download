var urlVehicleTypes=$("#urlVehicleTypes").attr("data-value");var urlVehicleYears=$("#urlVehicleYears").attr("data-value");var urlVehicleMakes=$("#urlVehicleMakes").attr("data-value");var urlVehicleModels=$("#urlVehicleModels").attr("data-value");var urlVehicleVIN=$("#urlVehicleVIN").attr("data-value");if(urlVehicleVIN!=null){urlVehicleVIN=urlVehicleVIN.trim();}var Fitment=function($type,$year,$make,$model,$saved,$findbutton,referrer){var levels=[$year,$make,$model];var referrer=referrer;var vehType={};var vehYear={};var vehMake={};var vehModel={};var vehModelList;var searchEnabled;var _initYMM=function(){wireEvents();};var init=function(){getTypes("N=0");};var reset=function(level){for(var i=levels.indexOf(level);i<levels.length;i++){levels[i].off("typeahead:selected blur keydown focus specialselect");var borderColor=levels[i][0].style.borderColor;levels[i].typeahead("destroy");levels[i][0].style.borderColor=borderColor;levels[i].val("");levels[i].prop("disabled",true);}};var consolelog=function(msg){};var getTypes=function(vehicleTypeNav){$.ajax({type:"GET",url:urlVehicleTypes+"/"+vehicleTypeNav,success:function(data){processTypes(data);}});};var processTypes=function(data){if(data.status=="error"){return false;}var refinements=JSON.parse(data.resultData).Refinements;$type.siblings(".gs-fitment-vehtype").empty();for(var i=0;i<refinements.length;i++){var active="";if(refinements[i].RefinementText.indexOf("Auto")===0){active=" active";vehType=refinements[i];$type.text(vehType.RefinementText);}$type.siblings(".gs-fitment-vehtype").append('<span class="gs-fitment-vehtypeitem'+active+'" data-name="'+refinements[i].RefinementText+'" data-nav="'+refinements[i].NavigationData+'" data-val="'+refinements[i].RefinementValue+'">'+refinements[i].RefinementText+"</span>");}$type.siblings(".gs-fitment-vehtype").find(".gs-fitment-vehtypeitem").on("mousedown",function(e){$(e.target).siblings().removeClass("active");$(e.target).addClass("active");$type.siblings(".gs-fitment-vehtype").hide();vehType.NavigationData=$(e.target).data("nav");vehType.RefinementText=$(e.target).data("name");vehType.RefinementValue=$(e.target).data("val");$type.text(vehType.RefinementText);getYears(vehType);$(document).off("keydown.fitment");});getYears(vehType);};var getYears=function(newType){vehType=newType;consolelog("getYears");reset($year);vehYear=vehMake=vehModel=null;$.ajax({type:"GET",cache:true,url:urlVehicleYears+"/"+vehType.NavigationData,success:function(data){processRefinements(data,$year,$make,getMakes);if($('[data-tabid="#new"]').length&&$('[data-tabid="#new"]').hasClass("active")){if($("#modal-year").length){$("#modal-year").focus();}}}});};var getMakes=function(newYear){consolelog("getMakes");vehYear=newYear;reset($make);vehMake=vehModel=null;$.ajax({url:urlVehicleMakes+"/"+vehYear.NavigationData,success:function(data){processRefinements(data,$make,$model,getModels);}});};var getModels=function(newMake){consolelog("getModels");vehMake=newMake;reset($model);vehModel=null;$.ajax({url:urlVehicleModels+"/"+vehMake.NavigationData,success:function(data){vehModelList=JSON.parse(data.resultData).Refinements.map(function(obj){obj.RefinementText=obj.RefinementText.replace("<sup>","").replace("</sup>","");return obj;});processRefinements(data,$model,null,enableSearch);}});};var enableSearch=function(newModel){vehModel=newModel;setTimeout(function(){$findbutton.focus();},250);};var processRefinements=function(data,$current,$next,callback){if(data.status=="error"){return false;}var isSelected=false;var refinements=JSON.parse(data.resultData).Refinements.map(function(obj){obj.RefinementText=obj.RefinementText.replace("<sup>","").replace("</sup>","");return obj;});var refinementslist=refinements.map(function(obj){return obj.RefinementText.replace("<sup>","").replace("</sup>","");});refinementslist=refinements.map(function(obj){return obj.RefinementText;});$current.typeahead("destroy");$current.prop("disabled",false);$current.typeahead({hint:true,highlight:true,minLength:0},{name:$current[0].className.split(" ")[0],source:substringMatcher(refinementslist),limit:Infinity});if($current!=$year){setTimeout(function(){$current.focus();if(refinementslist.length==1){$current.typeahead("val",refinementslist[0]);}},400);}if($current.selector=="#hero-model"){$current.siblings(".tt-menu").after('<div style="width:'+$current.outerWidth()+'px" class="tt-disclaimer">'+$("#vehDisclaimer").val()+"</div>");}$current.on("typeahead:selected blur",function(e,datum){consolelog(e.type);consolelog("isSelected "+String(isSelected));if($current==$year){if(vehYear&&($current[0].value==vehYear.RefinementText)){return true;}else{if(vehYear&&!isSuggestion($current)){$current[0].value=vehYear.RefinementText;return true;}}}if($current==$make){if(vehMake&&($current[0].value==vehMake.RefinementText)){return true;}else{if(vehMake&&!isSuggestion($current)){$current[0].value=vehMake.RefinementText;return true;}}}if($current==$model){if(vehModel&&!isSuggestion($current)){$current[0].value=vehModel.RefinementText;return true;}}if(!isSelected){advanceToNext($current,$next,refinements,refinementslist,callback);}});$current.on("focus",function(e){var temp=$current[0].value;$current.typeahead("val","");$current[0].value=temp;$current[0].setSelectionRange(0,9999);isSelected=false;});$current.on("keydown",function(e){consolelog(e.keyCode);consolelog(e.shiftKey);if(e.keyCode==13||e.keyCode==9&&!e.shiftKey){var $list=$current.siblings(".tt-menu").find(".tt-dataset .tt-suggestion");if($list.length){for(var i=0;i<$list.length;i++){if($($list[i]).text().toLowerCase()==$current[0].value.toLowerCase()){$list[i].click();if(isSelected){e.preventDefault();}return true;}}$list[0].click();if(isSelected){e.preventDefault();}return true;}}else{var curHeight=$current.siblings(".tt-menu").height()+40;$current.siblings(".tt-disclaimer").css("top",curHeight+"px");return true;}});$current.on("specialselect",function(){isSelected=true;});$current.on("typeahead:open",function(){consolelog("typeahead.open "+$current.selector);setTimeout(function(){var curHeight=$current.siblings(".tt-menu").height()+40;consolelog(curHeight);$current.siblings(".tt-disclaimer").css("top",curHeight+"px");$current.siblings(".tt-disclaimer").show();},50);});$current.on("typeahead:close",function(){consolelog("typeahead.close "+$current.selector);$current.siblings(".tt-disclaimer").hide();});};var advanceToNext=function($current,$next,refinements,refinementslist,callback){var curValue=$current[0].value.toLowerCase();for(var i=0;i<refinements.length;i++){if(refinementslist[i].toLowerCase()==curValue){$current.trigger("specialselect");if($next!=null){$next.off("keydown typeahead:selected blur typeahead:open typeahead:close");$next.typeahead("destroy");$next[0].value="";}$current.typeahead("close");$current.css("border-color","transparent");callback(clone(refinements[i]));return true;}}$current[0].value="";function clone(obj){if(null==obj||"object"!=typeof obj){return obj;}var copy=obj.constructor();for(var attr in obj){if(obj.hasOwnProperty(attr)){copy[attr]=obj[attr];}}return copy;}};var isSuggestion=function($current){var $list=$current.siblings(".tt-menu").find(".tt-dataset .tt-suggestion");if($list.length){for(var i=0;i<$list.length;i++){if($($list[i]).text()==$current[0].value){return true;}}}return false;};var substringMatcher=function(strs){return function findMatches(q,cb){q=q.replace(" **","");var matches,substringRegex;matches=[];var substrRegex=new RegExp("^"+q,"i");$.each(strs,function(i,str){if(substrRegex.test(str)){matches.push(str);}});cb(matches);};};var wireEvents=function(){$type.on("click",function(){$type.siblings(".gs-fitment-vehtype").show(10);$(document).on("keydown.fitment",function(event){if(event.keyCode===40){moveCursor(1,$type.siblings(".gs-fitment-vehtype").find(".gs-fitment-vehtypeitem"));event.preventDefault();}else{if(event.keyCode===38){moveCursor(-1,$type.siblings(".gs-fitment-vehtype").find(".gs-fitment-vehtypeitem"));event.preventDefault();}else{if(event.keyCode===13){$type.siblings(".gs-fitment-vehtype").find(".gs-fitment-vehtypeitem.active").mousedown();$type.siblings(".gs-fitment-vehtype").find(".gs-fitment-vehtypeitem.active").focusout();}}}});$type.siblings(".gs-fitment-vehtype").find(".gs-fitment-vehtypeitem").hover(function(e){$type.siblings(".gs-fitment-vehtype").find(".gs-fitment-vehtypeitem").removeClass("active");$(e.target).addClass("active");},function(e){});$(".gs-fitment-vehtypeitem").on("click");});$type.focus(function(e){$type.click();});$type.focusout(function(e){if($(".gs-fitment-vehtype.arrow_box").is(":visible")){$type.siblings(".gs-fitment-vehtype").hide();}});};var setNewVehicle=function(checkYMM,callback){if(checkYMM){for(var i=0;i<levels.length;i++){if(levels[i][0].value.length==0){levels[i].css("border-color","#FF4242");checkYMM=false;}}if(!checkYMM){return false;}}var myreferer=referrer,redirectToPtlp=false;if($("#veh-ymm-submit").length){if($("#veh-ymm-submit").data("currentpagetype")=="plp"){myreferer="plp";}if($("#veh-ymm-submit").data("currentpagetype")=="ptlp"){redirectToPtlp=ACC.config.encodedContextPath+"/search?referer=semantic&headerVehChange=true&text="+encodeURIComponent(vehYear.RefinementText+" "+vehMake.RefinementText+" "+vehModel.RefinementText+" "+$("#veh-ymm-submit").data("searchterm"));}}if($("#pageType").val()=="nrf"){vehModel.RefinementText=vehModel.RefinementText.replace(" **","");redirectToPtlp=ACC.config.encodedContextPath+"/search?referer=semantic&text="+encodeURIComponent(vehYear.RefinementText+" "+vehMake.RefinementText+" "+vehModel.RefinementText+" "+$("#keywordInput").val());}var formdata={vehicleTypeId:vehType.RefinementValue,vehicleType:vehType.RefinementText,yearId:vehYear.RefinementValue,year:vehYear.RefinementText,makeId:vehMake.RefinementValue,make:vehMake.RefinementText,modelId:vehModel.RefinementValue,model:vehModel.RefinementText.replace("**",""),referrer:referrer,vehicleSelectionType:"header-ymm",referer:myreferer,CSRFToken:ACC.config.CSRFToken};var makeId=formdata.modelId.substr(1,4);formdata.makeId="5"+makeId+"00";$.ajax({url:"/my-vehicle/add-vehicle/",type:"POST",data:$.param(formdata),success:function(data){if(data.status=="success"){if(redirectToPtlp){window.location.href=redirectToPtlp;return;}else{if($("#pageType").val()=="productDetails"){window.location.href=document.location.pathname+addUrlParam(document.location.search,"vehicleAddPDP","true");return;}}callback();}}});return true;};var setVehicleData=function(apiData){vehType={};vehYear={};vehMake={};vehModel={};vehType.RefinementText=apiData.vehicleTypeName;vehType.RefinementValue=apiData.endecaVehicleTypeId;vehYear.RefinementText=apiData.yearName;vehYear.RefinementValue=apiData.endecaYearId;vehMake.RefinementText=apiData.makeName;vehMake.RefinementValue=apiData.endecaMakeId;vehModel.RefinementText=apiData.modelName;vehModel.RefinementValue=apiData.endecaModelId;};var setSavedVehicle=function(callback){var userDefaultVehicle=$("#user-default-vehicle").data("user-default-vehicle");var vehicleId=$saved.val();if(userDefaultVehicle!=vehicleId){var redirectToPtlp=false;var secondaryParams={vehicleSelectionType:"header-ymm"};if($("#veh-ymm-submit").length){if($("#veh-ymm-submit").data("currentpagetype")=="plp"){secondaryParams={vehicleSelectionType:"header-ymm",referer:"plp"};}if($("#veh-ymm-submit").data("currentpagetype")=="ptlp"){redirectToPtlp=ACC.config.encodedContextPath+"/search?referer=semantic&text="+encodeURIComponent($saved.find("option:selected").data("ymm")+" "+$("#veh-ymm-submit").data("searchterm"));}}if($("#pageType").val()=="nrf"){redirectToPtlp=ACC.config.encodedContextPath+"/search?referer=semantic&text="+encodeURIComponent($saved.find("option:selected").data("ymm")+" "+$("#keywordInput").val());}$.ajax({url:ACC.config.encodedContextPath+"/my-vehicle/make-default-Vehicle/"+vehicleId,type:"GET",data:secondaryParams,success:function(data){if(data=="success"){if(redirectToPtlp){window.location.href=redirectToPtlp;return;}if($("#pageType").val()=="productDetails"){window.location.href=document.location.pathname+addUrlParam(document.location.search,"vehicleAddPDP","true");return;}callback();}}});}else{callback();}};var moveCursor=function(offset,$menu){var currIndex=0,newIndex=0;var qty=$menu.length;$menu.each(function(i,e){if($(e).hasClass("active")){currIndex=i;}});newIndex=currIndex+offset;if(newIndex<0){newIndex=qty-1;}if(newIndex>(qty-1)){newIndex=0;}$($menu[currIndex]).removeClass("active");$($menu[newIndex]).addClass("active");};return({initYMM:_initYMM,setVehicleData:setVehicleData,setNewVehicle:setNewVehicle,setSavedVehicle:setSavedVehicle,reset:reset,init:init});};var Hero=function(){var $saved=$("#gs-fitment-saved");var $type=$(".gs-fitment-type");var $year=$("#hero-year");var $make=$("#hero-make");var $model=$("#hero-model");var levels=[$year,$make,$model];var $findbutton=$(".gs-find-button");var fitment=Fitment($type,$year,$make,$model,$saved,$findbutton,"herofitmentForm");var setControls=function(){$("#herofitmentSearchText").val("");if($(".gs-fitment-saved-item.veh").length){$(".gs-fitment-savedvehs").show();$(".gs-fitment-inputs").hide();$type.hide();$("#gs-fitment-saved").selectmenu();$("#gs-fitment-saved").selectmenu("widget").addClass("gs-fitment-saved");if($("#gs-fitment-saved").val()=="new"){$("#gs-fitment-saved").val($("#gs-fitment-saved").children(":nth-child(2)").val());$("#gs-fitment-saved").selectmenu("refresh",true);}}else{$(".gs-fitment-inputs").show();$(".gs-fitment-type").show();$(".gs-fitment-savedvehs").hide();}};var wireEvents=function(){$findbutton.on("click",findButtonHandler);$saved.on("selectmenuselect",function(event,ui){if($saved.val()=="new"){event.preventDefault();executeNewVehicleSearch();}$saved.css("border-color","transparent");});$("#herofitmentSearchText").on("blur",function(){if($("#herofitmentSearchText").val().length>0){$("#herofitmentSearchText").css("border-color","transparent");}});$("#herofitmentSearchText").on("keydown",function(e){if($("#herofitmentSearchText").val().length>0&&e.keyCode==13){if($(".gs-fitment-saved-item.veh").length){$(".gs-find-button").click();}else{for(var i=0;i<levels.length;i++){if(levels[i][0].value.length==0){setTimeout(function(){levels[i].focus();},250);return false;}}$(".gs-find-button").click();}}else{if(e.keyCode==13){$("#herofitmentSearchText").css("border-color","#FF4242");}else{$("#herofitmentSearchText").css("border-color","transparent");}}if(e.keyCode==9){setTimeout(function(){if($("#gs-fitment-saved-button").length){$saved.selectmenu("open");}},200);}});$("#gs-fitment-saved-button").on("keyup",function(e){if(e.keyCode==13){$findbutton.click();}});$("#gs-fitment-saved-button").on("mousedown",function(e){e.preventDefault();e.stopPropagation();});};var executeNewVehicleSearch=function(){if($("#herofitmentSearchText").val()){$(".search-add-new-vehicle").attr("data-searchbar","true");$(".search-add-new-vehicle").attr("data-formname","herofitmentForm");$("#textSearch").val($("#herofitmentSearchText").val());}else{$(".search-add-new-vehicle").attr("data-searchbar","false");$(".search-add-new-vehicle").attr("data-formname","");$("#textSearch").val("");}$(".add-new-vehicle").click();$(".fitment-modal-close").on("click",function(e){$saved.selectmenu("option","disabled",false);});};var dimHighlight=function(state){$(".home-panel-i.fitment").off("click");$(".home-panel-i.products").off("click");if(state=="find"){$(".home-hero-dim").show();}else{if(state=="i-main"){$(".home-hero-dim").show();$(".home-fitment").css("z-index","1000");$(".home-hero-dim-tip.step1").show();$(".home-hero-dim-tip.step2").show();}else{if(state=="i-products"){$(".home-hero-dim").show();$(".home-products").css("z-index","1000");$(".home-hero-dim-tip.products").show();}else{if(state=="i-error"){$(".home-hero-dim").show();$(".home-fitment").css("z-index","1000");$(".home-hero-dim-tip.error").show();}else{for(var i=0;i<$(".home-hero-dim-tip").length;i++){if($($(".home-hero-dim-tip")[i]).is(":hover")){return false;}}$(".home-hero-dim").hide();$(".home-fitment").css("z-index","1");$(".home-products").css("z-index","1");$(".home-hero-dim-tip.step1").hide();$(".home-hero-dim-tip.step2").hide();$(".home-hero-dim-tip.products").hide();$(".home-hero-dim-tip.error").hide();$(document).off("click.hero");helpIconsInit();}}}}if(state!="off"){$(document).on("click.hero keypress.hero",function(e){dimHighlight("off");e.stopPropagation();});}};var productsModalInit=function(){var configuration=({otherClose:".hero-search-close",beforeOpen:function(e){if(AAData){merge(AAData,{page:{pageName:"all products",channel:"search",template:"modal"}});try{if(_satellite){_satellite.track("search_modal");}}catch(e){}}setTimeout(function(){$(".home-products-search").focus();},250);},beforeContent:function(){$(this.$instance).find(".featherlight-close").remove();$(this.$instance).find(".featherlight-content").css("border-bottom","none");$("body").addClass("stuck");},beforeClose:function(){$("body").removeClass("stuck");},persist:true});$(".home-products-button").featherlight($(".home-products-modal"),configuration);$(".home-products-search-button").on("click keypress",function(){var textSearch=$(this).siblings(".home-products-search").val();textSearch=textSearch.replace(/ /g,"+");if(textSearch){var searchTextUrl=ACC.config.encodedContextPath+"/search?text="+encodeURIComponent(textSearch)+"&isProduct=true&referer=herofitmentForm-allprod";window.location.href=searchTextUrl;}});$(".home-products-search").on("keydown",function(e){if(e.keyCode==13){$(".home-products-search-button").click();}});};var helpIconsInit=function(){$(".home-panel-i.fitment").on("click",function(e){dimHighlight("i-main");e.stopPropagation();});$(".home-panel-i.products").on("click",function(e){dimHighlight("i-products");e.stopPropagation();});};var findButtonHandler=function(e){e.preventDefault();var searchText=$("#herofitmentSearchText").val();searchText=searchText.replace(/ /g,"+");if(!searchText){$("#herofitmentSearchText").css("border-color","#FF4242");return false;}if($(".gs-fitment-inputs:visible").length>0){var enableSearch=fitment.setNewVehicle(true,function(){window.location.href=ACC.config.encodedContextPath+"/search?text="+encodeURIComponent(searchText)+"&referer=herofitmentForm-newveh";});if(!enableSearch){if(searchText){dimHighlight("i-error");}return false;}}else{var vehicleId=$saved.val();if(vehicleId=="new"){executeNewVehicleSearch();}fitment.setSavedVehicle(function(){window.location.href=ACC.config.encodedContextPath+"/search?text="+encodeURIComponent(searchText)+"&referer=herofitmentForm-savedveh";});}};var _init=function(){if($(".gs-fitment-inputs:visible").length>0){fitment.initYMM();}setControls();wireEvents();productsModalInit();helpIconsInit();};return{dimHighlight:dimHighlight,init:_init};}();var Modal=function(){var $saved=$("#fitment-modal-saved");var $type=$(".fitment-modal-type");var $year=$("#modal-year");var $make=$("#modal-make");var $model=$("#modal-model");var $findbutton=$(".fitment-select-button");var fitmentDialog;var searchUrl;var fitment=new Fitment($type,$year,$make,$model,$saved,$findbutton,"modal");var setControls=function(){if($saved.find(".gs-fitment-saved-item.veh").length){$saved.selectmenu();$saved.selectmenu("widget").addClass("fitment-modal-saved");}else{$(".fitment-modal-tab-saved").hide();}$type.siblings(".gs-fitment-vehtype").css("top","179px");$type.siblings(".gs-fitment-vehtype").css("left","52px");};var wireEvents=function(){$("ul.fitment-modal-tabs li").on("click keydown",function(e){if(e.type=="keydown"&&(e.keyCode!=13&&e.keyCode!=32&&e.keyCode!=9)){return true;}if(e.type=="keydown"&&e.keyCode==9){if($(this).data("tabid")=="#saved"&&!e.shiftKey&&$(this).hasClass("active")){$saved.selectmenu("open");return true;}else{return true;}}if($(this).data("tabid")=="#saved"){$(".fitment-modal-tab-vin").addClass("bg");}else{$(".fitment-modal-tab-vin").removeClass("bg");}if($(this).data("tabid")=="#vin"){$(".fitment-modal-tab-saved").removeClass("bg");}else{$(".fitment-modal-tab-saved").addClass("bg");}if($(this).data("tabid")=="#new"){if(!$year[0]||!$year[0].value.length){setTimeout(function(){$year.focus();},250);}}$("ul.fitment-modal-tabs li").removeClass("active");$(this).addClass("active");$(".fitment-modal-tab-content").hide();$($(this).data("tabid")).fadeIn(0);});$("ul.fitment-modal-tabs li:first").click();$(".fitment-select-button").on("click",setNewVehicle);$(".fitment-saved-button").on("click",setSavedVehicle);$(".fitment-vin-button").on("click",setVinVehicle);$(".fitment-modal-close").on("keydown",function(e){if(e.keyCode==9&&e.shiftKey){e.preventDefault();$("#modalMyVehicleAdd div.fitment-modal-tab-content:visible").find("input.button-primary").focus();}if(e.keyCode==13||e.keyCode==32){$(".fitment-modal-close").click();}});$("#modalMyVehicleAdd .button-primary.button-enable").on("keydown",function(e){if(e.keyCode==9&&!e.shiftKey){e.preventDefault();$(".fitment-modal-close").focus();}});$("body").on("click",'[data-trigger="fitment-modal"]',function(e){e.preventDefault();searchUrl=$(this).attr("data-referer");showModal(e);var targettab=$(this).data("vehicle-targettab");if($("#fitment-modal-saved")!=undefined&&!targettab){var length=$("#fitment-modal-saved > option").length;if(length>1){targettab="#saved";}else{if(length==1&&$(this).data("vehicle-not-selected")){targettab="#saved";}}}$('[data-tabid="'+targettab+'"]').click();$("#fitment-modal-saved-button").focus();});$("#fitment-vin").on("keyup",function(){if($("#fitment-vin").val().length){$("#fitment-vin").css("border-color","transparent");$("#fitment-vin").attr("aria-labelledby","");$(".fitment-modal-vin-error").text("");}});wireModal();};var showModal=function(e,dataReferer){var configuration={otherClose:".fitment-modal-close",beforeOpen:function(e){if(AAData){merge(AAData,{page:{pageName:"all products",channel:"search",template:"modal"}});try{if(_satellite){_satellite.track("search_modal");}}catch(e){}}},beforeContent:function(){$(this.$instance).find(".featherlight-close").remove();$(this.$instance).find(".featherlight-content").css("border-bottom","none");$(this.$instance).find(".featherlight-content").css("overflow","visible");$("body").addClass("stuck");if($(".search-job-add-new-vehicle").attr("data-parts-by-repairtype-click")==undefined){$(".vehicle-modal-msg-wrapper").css("display","none");var pad_top_val="40px";$(".fitment-modal-tab-content").css("padding-top",pad_top_val);}else{if($(".search-job-add-new-vehicle").attr("data-parts-by-repairtype-click")=="true"){$(".vehicle-modal-msg-wrapper").css("display","flex");var pad_top_val="0px";$(".fitment-modal-tab-content").css("padding-top",pad_top_val);}}},afterClose:function(){$("body").removeClass("stuck");if($(".search-job-add-new-vehicle").attr("data-parts-by-repairtype-click")=="true"){$(".search-job-add-new-vehicle").attr("data-parts-by-repairtype-click","false");}var myhref;try{ffmodal=sessionStorage.getItem("force-fitment-modal");myhref=sessionStorage.getItem("fitment-redirect");}catch(e){console.log(e);}if(ffmodal){try{sessionStorage.setItem("dont-force-fitment","true");}catch(e){console.log(e);}}if(!myhref){try{sessionStorage.removeItem("force-fitment-modal");}catch(e){console.log(e);}}else{try{sessionStorage.removeItem("fitment-redirect");sessionStorage.removeItem("force-fitment-modal");}catch(e){console.log(e);}window.location.href=myhref;}},beforeClose:function(){$(".vehicle-modal-msg-wrapper").css("display","none");var pad_top_val="40px";$(".fitment-modal-tab-content").css("padding-top",pad_top_val);},persist:true};$(document).click();if(!fitmentDialog){fitmentDialog=$.featherlight($("#modalMyVehicleAdd"),configuration);}else{fitmentDialog.open();}fitment.init();};var wireModal=function(){$(document).on("click",".add-new-vehicle",showModal);};var setNewVehicle=function(){fitment.setNewVehicle(true,function(){refreshOrSearch();});};var setVinVehicle=function(){var searchedVIN=$("#fitment-vin").val();var vinErrorMessage=$("#fitment-vin").attr("data-valid-vin-message");if(!searchedVIN.length){$("#fitment-vin").css("border-color","#FF4242");$(".fitment-modal-vin-error").text(vinErrorMessage);$("#fitment-vin").attr("aria-labelledby","vin-error");$("#fitment-vin").focus();return false;}var secondaryParams={vehicleSelectionType:"header-vin"};if($("#veh-ymm-submit").length){if($("#veh-ymm-submit").data("currentpagetype")=="plp"){secondaryParams={vehicleSelectionType:"header-vin",referer:"plp"};}}$.ajax({url:urlVehicleVIN+"/"+searchedVIN,type:"GET",data:secondaryParams,success:function(data){if(data.status=="error"){$("#fitment-vin").css("border-color","#FF4242");$(".fitment-modal-vin-error").text(data.errorMessageList[0]);$("#fitment-vin").attr("aria-labelledby","vin-error");$("#fitment-vin").focus();return false;}else{$("#fitment-vin").attr("aria-labelledby","");$(".fitment-modal-vin-error").text("");var vehicleInfo=data.vehicleData;fitment.setVehicleData(vehicleInfo);fitment.setNewVehicle(false,function(){refreshOrSearch();});}}});};var setSavedVehicle=function(){fitment.setSavedVehicle(function(){refreshOrSearch();});};var refreshOrSearch=function(){var searchAppIndexDataURL=$("#search-app-index-data").attr("data-url");var isSearchBar=$(".search-add-new-vehicle").attr("data-searchbar");var formname=$(".search-add-new-vehicle").attr("data-formname");var isPartByRepairTypeClick=$(".search-job-add-new-vehicle").attr("data-parts-by-repairtype-click");var textSearch=$("#textSearch").val();textSearch=textSearch.replace(/ /g,"+");var megaMenuJobtypeLink=$("#mega-menu-jobtype-link").attr("data-url");if(searchUrl!=undefined&&searchUrl!=""){try{sessionStorage.removeItem("fitment-redirect");sessionStorage.removeItem("force-fitment-modal");}catch(e){console.log(e);}window.location.href=searchUrl;}else{if(isSearchBar=="true"){window.location.href=ACC.config.encodedContextPath+"/search?text="+encodeURIComponent(textSearch)+"&referer="+formname+"-newveh";}else{if(megaMenuJobtypeLink!=undefined&&megaMenuJobtypeLink!=""&&isPartByRepairTypeClick=="true"){window.location.href=megaMenuJobtypeLink;}else{if(searchAppIndexDataURL!=undefined&&searchAppIndexDataURL!=""){if(searchAppIndexDataURL.indexOf("c/job")==-1){window.location.href=searchAppIndexDataURL+"&referer=vehicleAdd";}else{window.location.href=searchAppIndexDataURL+"?referer=vehicleAdd";}}else{window.location.reload();}}}}};var _init=function(){fitment.initYMM();setControls();wireEvents();};return{init:_init};}();$(function(){if($(".home-fitment").length){Hero.init();}Modal.init();$(document).ajaxStart(function(){$(".ajax-loader").fadeIn();$(".ajax-loader").attr("aria-busy","true");});$(document).ajaxStop(function(){$(".ajax-loader").fadeOut();$(".ajax-loader").attr("aria-busy","false");});if(!String.prototype.includes){String.prototype.includes=function(){return String.prototype.indexOf.apply(this,arguments)!==-1;};}});