NAPA=typeof NAPA==="object"?NAPA:{};NAPA.searchVehicleInline=new function(){var panelTrigger=$('[data-trigger="add-new-vehicleinline-panel-toggle"]'),panelSelected=$(".add-new-vehicleinline-selected-panel"),panelSelectedClass=".add-new-vehicleinline-selected-panel",vehicleSectionLinks=".add-new-vehicleinline-content-list-link",vehicleSectionYear=$(".add-new-vehicleinline-year"),vehicleSectionMake=$(".add-new-vehicleinline-make"),vehicleSectionModel=$(".add-new-vehicleinline-model"),vehicleSectionCondition=$(".add-new-vehicleinline-condition"),addNewVehicleInline=$(".vehicle-panel-inline"),addNewVehicleLink=$(".vehicle-panel-inline-class"),editExistingVehicleLink=$(".edit-existing-vehicle"),addNewVehicleotherLink=$(".add-new-vehicleinline-panel-others-link"),addNewVehicleModel=$(".add-vehicle"),addNewVehicleselctlistInline=$(".add-new-vehicleinline-year-select"),addNewVehicleSearchInput=$(".add-new-vehicleinline-year-input-button"),addNewVehicleOthersPanel=$(".add-new-vehicleinline-others-panel"),urlVehicleVIN=$("#urlVehicleVIN").attr("data-value"),urlVehicleTypes=$("#urlVehicleTypes").attr("data-value"),urlVehicleYears=$("#urlVehicleYears").attr("data-value"),urlVehicleMakes=$("#urlVehicleMakes").attr("data-value"),urlVehicleModels=$("#urlVehicleModels").attr("data-value"),isYearNotFound=true,inputAddNewVehicleSearch=$(".add-new-vehicleinline-search .add-new-vehicleinline-search-input"),btnAddNewVehicleSearch=$(".add-new-vehicleinline-search .add-new-vehicleinline-search-button");rootNavigationID=$("#defaultRootNavigationData").attr("data-root-navigation-data"),defaultVehicleRefinementText=$(".add-new-vehicle").attr("data-default-type-text");vehicleColumnCount=6;var init=function(){panelTrigger.on("click",togglePanels);toggleSections();toggleVehiclePanel();addNewVehicleSearch();addNewVehicleselect();};var toggleVehiclePanel=function(){handleClearAllVehicleSearch();$('[data-trigger="vehicle-panel-inline"]').on("click",function(event){$(addNewVehicleInline).find(".add-new-vehicleinline-complete-buttons .button-add-new-vehicle").show();$(addNewVehicleInline).find(".add-new-vehicleinline-complete-buttons .button-edit-existing-vehicle").hide();$(".add-new-vehicleinline-section-value").removeClass("edit");handleClearVINSearch();handleFirstTypeSelection();var el=$(this);el.parents(".vehicle-panel-container").removeClass("vehicle-panel-conditions-open").addClass("vehicle-panel-inline-open");event.preventDefault();});$(".vehicle-panel-inline-close").on("click",function(event){var el=$(this);el.parents(".vehicle-panel-container").removeClass("vehicle-panel-conditions-open").removeClass("vehicle-panel-inline-open");event.preventDefault();});$('[data-trigger="vehicle-panel-conditions"]').on("click",function(event){var el=$(this);el.parents(".vehicle-panel-container").removeClass("vehicle-panel-inline-open").addClass("vehicle-panel-conditions-open");event.preventDefault();});$(".vehicle-panel-conditions-close").on("click",function(event){var el=$(this);el.parents(".vehicle-panel-container").removeClass("vehicle-panel-inline-open").removeClass("vehicle-panel-conditions-open");event.preventDefault();});};var togglePanels=function(event){var panelWrap=$(this).parents(".add-new-vehicleinline-panel");panelWrap.toggleClass("add-new-vehicleinline-panel-selected add-new-vehicleinline-panel-others");event.preventDefault();};var toggleSections=function(){$(".add-new-vehicleinline-search-input").on("blur",function(){if(!$(this).hasClass("error")){$(this).addClass("error").parents(".pure-form");}});vehicleSectionYear.on("click",vehicleSectionLinks,function(event){handleClearVINSearch();$(this).parents(panelSelectedClass).removeClass("add-new-vehicleinline-show-year").addClass("add-new-vehicleinline-show-make");$(".add-new-vehicleinline-section").removeClass("add-new-vehicleinline-section-active add-new-vehicleinline-section-complete");$(".add-new-vehicleinline-section-year").addClass("add-new-vehicleinline-section-complete");$(".add-new-vehicleinline-section-make").addClass("add-new-vehicleinline-section-active");var selectedYear=$(this).text();var navigationData=$(this).attr("data-navigation");var refinementValue=$(this).attr("data-refinement-value");handleYearSelection(navigationData,selectedYear,refinementValue);handleAddNewVehicleFormData();event.preventDefault();});vehicleSectionMake.on("click",vehicleSectionLinks,function(event){handleClearVINSearch();$(this).parents(panelSelectedClass).removeClass("add-new-vehicleinline-show-make").addClass("add-new-vehicleinline-show-model");$(".add-new-vehicleinline-section").removeClass("add-new-vehicleinline-section-active add-new-vehicleinline-section-complete");$(".add-new-vehicleinline-section-year").addClass("add-new-vehicleinline-section-complete");$(".add-new-vehicleinline-section-make").addClass("add-new-vehicleinline-section-complete");$(".add-new-vehicleinline-section-model").addClass("add-new-vehicleinline-section-active");var selectedMake=$(this).text();var navigationData=$(this).attr("data-navigation");var refinementValue=$(this).attr("data-refinement-value");handleMakeSelection(navigationData,selectedMake,refinementValue);handleAddNewVehicleFormData();event.preventDefault();});vehicleSectionModel.on("click",vehicleSectionLinks,function(event){handleClearVINSearch();if($(this).parents(".add-new-vehicleinline-panel").hasClass("add-new-vehicleinline-panel-inline")){$(this).parents(panelSelectedClass).removeClass("add-new-vehicleinline-show-model").addClass("add-new-vehicleinline-show-condition");$(".add-new-vehicleinline-section").removeClass("add-new-vehicleinline-section-active add-new-vehicleinline-section-complete");$(".add-new-vehicleinline-section-year").addClass("add-new-vehicleinline-section-complete");$(".add-new-vehicleinline-section-make").addClass("add-new-vehicleinline-section-complete");$(".add-new-vehicleinline-section-model").addClass("add-new-vehicleinline-section-complete");}else{$(".add-new-vehicleinline-section").removeClass("add-new-vehicleinline-section-active add-new-vehicleinline-section-complete");$(this).parents(panelSelectedClass).removeClass("add-new-vehicleinline-show-model").addClass("add-new-vehicleinline-show-complete");$(".add-new-vehicleinline-section-year").addClass("add-new-vehicleinline-section-complete");$(".add-new-vehicleinline-section-make").addClass("add-new-vehicleinline-section-complete");$(".add-new-vehicleinline-section-model").addClass("add-new-vehicleinline-section-complete");}var selectedModel=$(this).text();var navigationData=$(this).attr("data-navigation");var refinementValue=$(this).attr("data-refinement-value");handleModelSelection(navigationData,selectedModel,refinementValue);handleAddNewVehicleFormData();event.preventDefault();});addNewVehicleOthersPanel.on("click",vehicleSectionLinks,function(){handleClearVINSearch();handleClearAllVehicleSearch();$(".add-new-vehicleinline-panel").removeClass("add-new-vehicleinline-panel-others").addClass("add-new-vehicleinline-panel-selected");var vehicleType=$(this).text();var navigationData=$(this).attr("data-navigation");var refinementValue=$(this).attr("data-refinement-value");handleVehicleTypeChange(navigationData,vehicleType,refinementValue);event.preventDefault();});$(".add-new-vehicleinline-section-value").on("click",function(event){if($(this).hasClass("disabled")){event.preventDefault();return false;}else{disableVehicleModalDisclamirContent();handleClearVINSearch();var parentSection=$(this).parents(".add-new-vehicleinline-section");if(parentSection.hasClass("add-new-vehicleinline-section-year")){$(this).parents(panelSelectedClass).addClass("add-new-vehicleinline-show-year").removeClass("add-new-vehicleinline-show-make").removeClass("add-new-vehicleinline-show-model").removeClass("add-new-vehicleinline-show-complete").removeClass("add-new-vehicleinline-show-condition");$(".add-new-vehicleinline-section").removeClass("add-new-vehicleinline-section-active add-new-vehicleinline-section-complete");$(".add-new-vehicleinline-section-year").addClass("add-new-vehicleinline-section-active");$(this).text("").attr({"data-navigation":"","data-refinement-value":""});$(".add-new-vehicleinline-section-make .add-new-vehicleinline-section-value").text("").attr({"data-navigation":"","data-refinement-value":""});$(".add-new-vehicleinline-section-model .add-new-vehicleinline-section-value").text("").attr({"data-navigation":"","data-refinement-value":""});handleClearAddNewVehicleFormData();$(".add-new-vehicleinline-content-grid.make").remove();$(".add-new-vehicleinline-content-grid.model").remove();var vehicleTypeName=$(".vehicle-panel-inline .add-new-vehicleinline-panel-selected-link").text();var vehicleTypeRefinementValue=$(".vehicle-panel-inline .add-new-vehicleinline-panel-selected-link").attr("data-refinement-value");var vehicleTypeNavID=$(".vehicle-panel-inline .add-new-vehicleinline-panel-selected-link").attr("data-navigation");if($(this).hasClass("edit")){getOtherVehicleYearsByType(vehicleTypeName,vehicleTypeNavID);}}if(parentSection.hasClass("add-new-vehicleinline-section-make")){$(this).parents(panelSelectedClass).removeClass("add-new-vehicleinline-show-year").addClass("add-new-vehicleinline-show-make").removeClass("add-new-vehicleinline-show-model").removeClass("add-new-vehicleinline-show-complete").removeClass("add-new-vehicleinline-show-condition");$(".add-new-vehicleinline-section").removeClass("add-new-vehicleinline-section-active add-new-vehicleinline-section-complete");$(".add-new-vehicleinline-section-year").addClass("add-new-vehicleinline-section-complete");$(".add-new-vehicleinline-section-make").addClass("add-new-vehicleinline-section-active");enableVehicleModalDisclamirContent();$(this).text("").attr({"data-navigation":"","data-refinement-value":""});$(".vehicle-panel-inline #inputHiddenEndecaVehicleMakeId").val("");$(".vehicle-panel-inline #inputHiddenVehicleTypeMakeName").val("");$(".vehicle-panel-inline #inputHiddenEndecaVehicleModelId").val("");$(".vehicle-panel-inline #inputHiddenVehicleTypeModelName").val("");$(".add-new-vehicleinline-content-grid.model").remove();$(".add-new-vehicleinline-section-model .add-new-vehicleinline-section-value").text("").attr({"data-navigation":"","data-refinement-value":""});var vehicleYearName=$(".vehicle-panel-inline .add-new-vehicleinline-section-year .add-new-vehicleinline-section-value").text();var vehicleYearRefinementValue=$(".vehicle-panel-inline .add-new-vehicleinline-section-year .add-new-vehicleinline-section-value.edit").attr("data-refinement-value");var vehicleYearNavID=$(".vehicle-panel-inline .add-new-vehicleinline-section-year .add-new-vehicleinline-section-value.edit").attr("data-navigation");if($(this).hasClass("edit")){handleYearSelection(vehicleYearNavID,vehicleYearName,vehicleYearRefinementValue);}}if(parentSection.hasClass("add-new-vehicleinline-section-model")){$(this).parents(panelSelectedClass).removeClass("add-new-vehicleinline-show-year").removeClass("add-new-vehicleinline-show-make").addClass("add-new-vehicleinline-show-model").removeClass("add-new-vehicleinline-show-complete").removeClass("add-new-vehicleinline-show-condition");$(".add-new-vehicleinline-section").removeClass("add-new-vehicleinline-section-active add-new-vehicleinline-section-complete");$(".add-new-vehicleinline-section-year").addClass("add-new-vehicleinline-section-complete");$(".add-new-vehicleinline-section-make").addClass("add-new-vehicleinline-section-complete");$(".add-new-vehicleinline-section-model").addClass("add-new-vehicleinline-section-active");$(".vehicle-panel-inline #inputHiddenEndecaVehicleModelId").val("");$(".vehicle-panel-inline #inputHiddenVehicleTypeModelName").val("");$(this).text("").attr({"data-navigation":"","data-refinement-value":""});var vehicleMakeName=$(".vehicle-panel-inline .add-new-vehicleinline-section-make .add-new-vehicleinline-section-value").text();var vehicleMakeRefinementValue=$(".vehicle-panel-inline .add-new-vehicleinline-section-make .add-new-vehicleinline-section-value.edit").attr("data-refinement-value");var vehicleMakeNavID=$(".vehicle-panel-inline .add-new-vehicleinline-section-make .add-new-vehicleinline-section-value.edit").attr("data-navigation");if($(this).hasClass("edit")){handleMakeSelection(vehicleMakeNavID,vehicleMakeName,vehicleMakeRefinementValue);}}event.preventDefault();}});};btnAddNewVehicleSearch.on("click",function(e){e.preventDefault();searchedVIN=$(this).prevAll(".add-new-vehicleinline-search-input").val();var form=$(this).parents("form#formVINNumber");var inputVINsearchBox=$(this).prevAll(".add-new-vehicleinline-search-input");$(".add-new-vehicleinline-year-input").val("").removeClass("error").next(".error-messages").find(".error-message").html("");$(inputVINsearchBox).parents(".modal-content").find(".notification").hide().find(".notification-text").remove();$(form).parsley();$(form).parsley().validate();if($(form).parsley("isValid").validationResult){$.ajax({url:urlVehicleVIN+"/"+searchedVIN,type:"GET",success:function(data){if(data.status=="error"){$(inputVINsearchBox).parents(".modal-content").find(".notification").show().addClass("notification-error").append('<p class="notification-text">'+data.errorMessageList[0]+"</p>");return false;}else{var vehicleInfo=data.vehicleData;$(".add-new-vehicleinline-content-grid.year").remove();$(".add-new-vehicleinline-content-grid.make").remove();$(".add-new-vehicleinline-content-grid.model").remove();$(".add-new-vehicleinline-section-year, .add-new-vehicleinline-section-make, .add-new-vehicleinline-section-model").removeClass("add-new-vehicleinline-section-active").addClass("add-new-vehicleinline-section-complete");$(".add-new-vehicleinline-panel-selected-link").text(vehicleInfo.vehicleTypeName).attr("data-refinement-value",vehicleInfo.endecaVehicleTypeId);$(".add-new-vehicleinline-section-year .add-new-vehicleinline-section-value").text(vehicleInfo.yearName).attr("data-refinement-value",vehicleInfo.endecaYearId);$(".add-new-vehicleinline-section-make .add-new-vehicleinline-section-value").text(vehicleInfo.makeName).attr("data-refinement-value",vehicleInfo.endecaMakeId);$(".add-new-vehicleinline-section-model .add-new-vehicleinline-section-value").text(vehicleInfo.modelName).attr("data-refinement-value",vehicleInfo.endecaModelId);$(".add-new-vehicleinline-section-year .add-new-vehicleinline-section-value").text(vehicleInfo.yearName).attr("data-refinement-value",vehicleInfo.endecaYearId);$(".add-new-vehicleinline-selected-panel").removeClass("add-new-vehicleinline-show-year").addClass("add-new-vehicleinline-show-complete");handleAddNewVehicleFormData();$(".add-new-vehicleinline-section .add-new-vehicleinline-section-value, .add-new-vehicleinline-panel-selected-link").addClass("disabled");}}});}});var getVehicleYearsByType=function(vehicleType,navigationData){$.ajax({url:urlVehicleYears+"/"+navigationData+"?from=inline_getVehicleYearsByType",success:function(data){if(data.status=="error"){$(addNewVehicleInline).find(".notification .notification-text").remove();$(addNewVehicleInline).find(".notification").show().addClass("notification-error").append('<p class="notification-text">'+data.errorMessageList[0]+"</p>");return false;}else{var years=JSON.parse(data.resultData).Refinements;if(years.length==0){$(addNewVehicleInline).find(".notification .notification-text").remove();$(addNewVehicleInline).find(".notification").show().addClass("notification-error").append('<p class="notification-text">'+data.errorMessageList[0]+"</p>");return false;}var listDiv=$(addNewVehicleInline).find(".add-new-vehicleinline-year .row.flushed");var pageSize=24;$(listDiv).find(".add-new-vehicleinline-content-grid.year").remove();$(listDiv).find(".add-new-vehicleinline-year-select").find("option").not(":first-child").remove();$.each(years,function(i,item){if(i>=0&&i<pageSize){$(listDiv).append('<li class="add-new-vehicleinline-content-list-item"><a class="add-new-vehicleinline-content-list-link"  data-navigation='+years[i].NavigationData+" data-refinement-value="+years[i].RefinementValue+'  href="#">'+years[i].RefinementText+"</li>");}else{if(i>=pageSize&&i<=years.length){$(listDiv).find(".add-new-vehicleinline-year-select").append("<option>"+years[i].RefinementText+"</option>");}}});var itemLi=$(listDiv).find(".add-new-vehicleinline-content-list-item");var liPerDiv=6;for(var i=0;i<pageSize;i+=liPerDiv){itemLi.filter(":eq("+i+"),:lt("+(i+liPerDiv)+"):gt("+i+")").wrapAll('<div class="add-new-vehicleinline-content-grid year"><ul class="add-new-vehicleinline-content-list">');}}}});};var getOtherVehicleYearsByType=function(vehicleType,navigationData){$.ajax({url:urlVehicleYears+"/"+navigationData+"?from=inline_getOtherVehicleYearsByType",success:function(data){if(data.status=="error"){$(addNewVehicleInline).find(".notification .notification-text").remove();$(addNewVehicleInline).find(".notification").show().addClass("notification-error").append('<p class="notification-text">'+data.errorMessageList[0]+"</p>");return false;}else{var years=JSON.parse(data.resultData).Refinements;if(years.length==0){$(addNewVehicleInline).find(".vehicle-error").replaceWith("<p>"+data.errorMessageList[0]+"</p>");return false;}var listDiv=$(addNewVehicleInline).find(".add-new-vehicleinline-year .row.flushed");var pageSize=24;$(listDiv).find(".add-new-vehicleinline-content-grid.year").remove();$(addNewVehicleInline).find(".add-new-vehicleinline-year-select").find("option").not(":first-child").remove();$.each(years,function(i,item){if(i>=0&&i<pageSize){$(listDiv).append('<li class="add-new-vehicleinline-content-list-item"><a class="add-new-vehicleinline-content-list-link"  data-navigation='+years[i].NavigationData+" data-refinement-value="+years[i].RefinementValue+'  href="#">'+years[i].RefinementText+"</li>");}else{if(i>=pageSize&&i<=years.length){$(addNewVehicleInline).find(".add-new-vehicleinline-year-select").append("<option>"+years[i].RefinementText+"</option>");}}});var itemLi=$(listDiv).find(".add-new-vehicleinline-content-list-item");var liPerDiv=6;for(var i=0;i<pageSize;i+=liPerDiv){itemLi.filter(":eq("+i+"),:lt("+(i+liPerDiv)+"):gt("+i+")").wrapAll('<div class="add-new-vehicleinline-content-grid year"><ul class="add-new-vehicleinline-content-list">');}}}});};addNewVehicleLink.on("click",function(event){$(".add-new-vehicleinline-complete-buttons .button-add-new-vehicle").show();$(".add-new-vehicleinline-complete-buttons  .button-edit-existing-vehicle").hide();$(".add-new-vehicleinline-section-value").removeClass("edit");handleClearVINSearch();handleFirstTypeSelection();event.preventDefault();});editExistingVehicleLink.on("click",function(event){handleClearVINSearch();$(".add-new-vehicleinline-complete-buttons  .button-add-new-vehicle").hide();$(".add-new-vehicleinline-complete-buttons  .button-edit-existing-vehicle").show();var vehicleTypeName=$(this).attr("data-type-refinement-text");var vehicleTypeRefinementValue=$(this).attr("data-type-refinement-value");var vehicleTypeNavID=$(this).attr("data-type-nav-id");var vehicleYearName=$(this).attr("data-year-refinement-text");var vehicleYearRefinementValue=$(this).attr("data-year-refinement-value");var vehicleYearNavID=$(this).attr("data-year-nav-id");var vehicleMakeName=$(this).attr("data-make-refinement-text");var vehicleMakeRefinementValue=$(this).attr("data-make-refinement-value");var vehicleMakeNavID=$(this).attr("data-make-nav-id");var vehicleModelName=$(this).attr("data-model-refinement-text");var vehicleModelRefinementValue=$(this).attr("data-model-refinement-value");var vehicleModelNavID=$(this).attr("data-model-nav-id");var vehicleID=$(this).attr("data-vehicle-id");handleClearAllVehicleSearch();handleClearVINSearch();handleTypeSelection(vehicleTypeName,vehicleTypeNavID);$(".add-new-vehicleinline-panel-selected-link").text(vehicleTypeName).attr("data-refinement-value",vehicleTypeRefinementValue).attr("data-navigation",vehicleTypeNavID);$(".add-new-vehicleinline-section-year .add-new-vehicleinline-section-value").addClass("edit").text(vehicleYearName).attr("data-refinement-value",vehicleYearRefinementValue).attr("data-navigation",vehicleYearNavID);$(".add-new-vehicleinline-section-make .add-new-vehicleinline-section-value").addClass("edit").text(vehicleMakeName).attr("data-refinement-value",vehicleMakeRefinementValue).attr("data-navigation",vehicleMakeNavID);$(".add-new-vehicleinline-section-model .add-new-vehicleinline-section-value").addClass("edit").text(vehicleModelName).attr("data-refinement-value",vehicleModelRefinementValue);$(".add-new-vehicleinline-selected-panel").removeClass("add-new-vehicleinline-show-year").addClass("add-new-vehicleinline-show-complete");$(".add-new-vehicleinline-section").removeClass("add-new-vehicleinline-section-active").addClass("add-new-vehicleinline-section-complete");handleAddNewVehicleFormData();if(vehicleID!==null&&vehicleID!==""){$(addNewVehicleInline).find("#inputHiddenVehicleId").val(vehicleID);}event.preventDefault();return false;});var handleFirstTypeSelection=function(navigationData){handleClearAllVehicleSearch();var typesListDiv=$(".vehicle-panel-inline").find(".add-new-vehicleinline-others-panel .add-new-vehicleinline-type-minor .row.flushed");$(".vehicle-panel-inline").find(".add-new-vehicleinline-others-panel .add-new-vehicleinline-type-minor .row.flushed .grid-4.type").remove();$.ajax({url:urlVehicleTypes+"/"+rootNavigationID+"?from=inline_handleFirstTypeSelection",success:function(data){if(data.status=="error"){$(".vehicle-panel-inline").find(".notification .notification-text").remove();$(".vehicle-panel-inline").find(".notification").show().addClass("notification-error").append('<p class="notification-text">'+data.errorMessageList[0]+"</p>");return false;}else{var types=JSON.parse(data.resultData).Refinements;if(types.length==0){$(".vehicle-panel-inline").find(".vehicle-error").append("<p>"+data.errorMessageList[0]+"</p>");return false;}$.each(types,function(i,item){if(defaultVehicleRefinementText===types[i].RefinementText){navigationData=types[i].NavigationData;$(".add-new-vehicleinline-type-major-link").text(types[i].RefinementText).attr("data-navigation",navigationData).attr("data-refinement-value",types[i].RefinementValue);$(".vehicle-panel-inline").find(".add-new-vehicleinline-panel-selected-link").text(defaultVehicleRefinementText).attr("data-navigation",navigationData).attr("data-refinement-value",types[i].RefinementValue);}$(".add-new-vehicleinline-type-minor .row.flushed").append('<li class="add-new-vehicleinline-content-list-item"><a class="add-new-vehicleinline-content-list-link" data-navigation='+types[i].NavigationData+" data-refinement-value="+types[i].RefinementValue+' href="#">'+types[i].RefinementText+"</li>");});var itemTypesLi=$(".vehicle-panel-inline").find(".add-new-vehicleinline-type-minor .row.flushed .add-new-vehicleinline-content-list-item");var pageSize=itemTypesLi.length;var liTypesPerDiv=1;for(var i=0;i<pageSize;i+=liTypesPerDiv){itemTypesLi.filter(":eq("+i+"),:lt("+(i+liTypesPerDiv)+"):gt("+i+")").wrapAll('<div class="grid-4 type"><ul class="add-new-vehicleinline-content-list">');}getVehicleYearsByType(defaultVehicleRefinementText,navigationData);}}});};var handleTypeSelection=function(selectedVehicle,navigationData){handleClearAllVehicleSearch();var typesListDiv=$(addNewVehicleModel).find(".add-new-vehicleinline-others-panel .add-new-vehicleinline-type-minor .row.flushed");$(addNewVehicleModel).find(".add-new-vehicleinline-others-panel .add-new-vehicleinline-type-minor .row.flushed .grid-4.type").remove();$.ajax({url:urlVehicleTypes+"/"+rootNavigationID+"?from=inline_handleFirstTypeSelection",success:function(data){if(data.status=="error"){$(addNewVehicleInline).find(".notification .notification-text").remove();$(addNewVehicleInline).find(".notification").show().addClass("notification-error").append('<p class="notification-text">'+data.errorMessageList[0]+"</p>");return false;}else{var types=JSON.parse(data.resultData).Refinements;if(types.length==0){$(addNewVehicleInline).find(".vehicle-error").append("<p>"+data.errorMessageList[0]+"</p>");return false;}$.each(types,function(i,item){if(defaultVehicleRefinementText===types[i].RefinementText){navigationData=types[i].NavigationData;$(".add-new-vehicleinline-type-major-link").text(types[i].RefinementText).attr("data-navigation",navigationData).attr("data-refinement-value",types[i].RefinementValue);}$(".add-new-vehicleinline-type-minor .row.flushed").append('<li class="add-new-vehicleinline-content-list-item"><a class="add-new-vehicleinline-content-list-link" data-navigation='+types[i].NavigationData+" data-refinement-value="+types[i].RefinementValue+' href="#">'+types[i].RefinementText+"</li>");});var itemTypesLi=$(".add-new-vehicleinline-type-minor .row.flushed .add-new-vehicleinline-content-list-item");var pageSize=itemTypesLi.length;var liTypesPerDiv=1;for(var i=0;i<pageSize;i+=liTypesPerDiv){itemTypesLi.filter(":eq("+i+"),:lt("+(i+liTypesPerDiv)+"):gt("+i+")").wrapAll('<div class="grid-4 type"><ul class="add-new-vehicleinline-content-list">');}getVehicleYearsByType(selectedVehicle,navigationData);}}});};var handleYearSelection=function(naviationdata,selectedYear,refinementValue){enableVehicleModalDisclamirContent();$(".add-new-vehicleinline-section-year").find(".add-new-vehicleinline-section-value").text(selectedYear).attr("data-navigation",naviationdata).attr("data-refinement-value",refinementValue);var makesListDiv=$(addNewVehicleInline).find(".add-new-vehicleinline-make .row.flushed");$(makesListDiv).find(".add-new-vehicleinline-content-grid.make").remove();$(".add-new-vehicleinline-content-grid.make").find(".add-new-vehicleinline-content-list-item").remove();$.ajax({url:urlVehicleMakes+"/"+naviationdata,success:function(data){if(data.status=="error"){$(".add-new-vehicleinline-selected-panel").find(".notification .notification-text").remove();$(".add-new-vehicleinline-selected-panel").find(".notification").show().addClass("notification-error").append('<p class="notification-text">'+data.errorMessageList[0]+"</p>");return false;}else{var makes=JSON.parse(data.resultData).Refinements;var pageSize=makes.length,columns=vehicleColumnCount;if(pageSize==0){$(".add-new-vehicleinline-selected-panel").find(".notification .notification-text").remove();$(".add-new-vehicleinline-selected-panel").find(".notification").show().addClass("notification-error").append('<p class="notification-text">'+data.errorMessageList[0]+"</p>");return false;}$.each(makes,function(i,item){$(makesListDiv).append('<li class="add-new-vehicleinline-content-list-item"><a class="add-new-vehicleinline-content-list-link"  data-navigation='+makes[i].NavigationData+" data-refinement-value="+makes[i].RefinementValue+' href="#">'+makes[i].RefinementText+"</li>");});var makesLi=$(".add-new-vehicleinline-make .row.flushed .add-new-vehicleinline-content-list-item");var liMakesPerDiv=Math.ceil(pageSize/columns);var gridWidth=(100/columns);for(var i=0;i<pageSize;i+=liMakesPerDiv){makesLi.filter(":eq("+i+"),:lt("+(i+liMakesPerDiv)+"):gt("+i+")").wrapAll('<div class="add-new-vehicleinline-content-grid make" style="width:'+gridWidth+'%"><ul class="add-new-vehicleinline-content-list">');}return false;}}});};var handleMakeSelection=function(naviationdata,selectedMake,refinementValue){disableVehicleModalDisclamirContent();$(".add-new-vehicleinline-section-make").find(".add-new-vehicleinline-section-value").text(selectedMake).attr("data-navigation",naviationdata).attr("data-refinement-value",refinementValue);var modelsListDiv=$(addNewVehicleInline).find(".add-new-vehicleinline-model .row.flushed");$.ajax({url:urlVehicleModels+"/"+naviationdata,success:function(data){if(data.status=="error"){$(addNewVehicleInline).find(".notification .notification-text").remove();$(addNewVehicleInline).find(".notification").show().addClass("notification-error").append('<p class="notification-text">'+data.errorMessageList[0]+"</p>");return false;}else{var models=JSON.parse(data.resultData).Refinements;var numberOfModels=models.length,pageSize=numberOfModels,columns=vehicleColumnCount;$(modelsListDiv).find(".add-new-vehicleinline-content-grid.model").remove();$.each(models,function(i,item){$(modelsListDiv).append('<li class="add-new-vehicleinline-content-list-item"><a class="add-new-vehicleinline-content-list-link" data-navigation='+models[i].NavigationData+" data-refinement-value="+models[i].RefinementValue+' href="#">'+models[i].RefinementText+"</li>");});var modelsLi=$(".add-new-vehicleinline-model .row.flushed .add-new-vehicleinline-content-list-item");var liModelsPerDiv=Math.ceil(pageSize/columns);var gridWidth=(100/columns);for(var i=0;i<=pageSize;i+=liModelsPerDiv){modelsLi.filter(":eq("+i+"),:lt("+(i+liModelsPerDiv)+"):gt("+i+")").wrapAll('<div class="add-new-vehicleinline-content-grid model" style="width:'+gridWidth+'%"><ul class="add-new-vehicleinline-content-list">');}if(numberOfModels==0){$(".add-new-vehicleinline-selected-panel").removeClass("add-new-vehicleinline-show-model").addClass("add-new-vehicleinline-show-complete");$(".add-new-vehicleinline-section-model").addClass("add-new-vehicleinline-section-complete");}return false;}}});};var addNewVehicleSearch=function(vehicleType,navigationData){$(addNewVehicleSearchInput).on("click",function(e){var searchVehicleYearForm=$(this).parents("form");var selectedYear=$(searchVehicleYearForm).find("input").val();isYearNotFound=true;var searchYearInputbox=$(searchVehicleYearForm).find("input");var yearNotFoundMessage=$(this).attr("data-year-not-found-message");var navigationData=$(".vehicle-panel-inline").find(".add-new-vehicleinline-panel-selected-link").attr("data-navigation");var refinementValue=$(".vehicle-panel-inline").find(".add-new-vehicleinline-panel-selected-link").attr("data-refinement-value");var removeDivs=$(this).parent().siblings(".add-new-vehicle-content-grid.year");var listDiv=$(this).parents().find(".add-new-vehicle-year .row.flushed");$(searchVehicleYearForm).parsley();$(searchVehicleYearForm).parsley().validate();if(selectedYear.length<=4&&$(searchVehicleYearForm).parsley("isValid").validationResult){$.ajax({url:urlVehicleYears+"/"+navigationData+"?from=inline_addNewVehicleSearchInput",success:function(data){if(data.status=="error"){$(".add-new-vehicle-selected-panel").find(".notification").removeClass("notification-error").children("p").remove();$(".add-new-vehicle-selected-panel").find(".notification").show().addClass("notification-error").append('<p class="notification-text">'+data.errorMessageList[0]+"</p>");return false;}else{var years=JSON.parse(data.resultData).Refinements;if(years.length==0){searchYearInputbox.removeClass("success").addClass("error").next(".error-messages").append('<p class="error-message">'+data.errorMessageList[0]+"</p>");yearErrorMessage=data.errorMessageList[0];return false;}$.each(years,function(i,item){if(years[i].RefinementText===selectedYear){isYearNotFound=false;$(".add-new-vehicleinline-selected-panel").find(".notification").hide();$(".add-new-vehicleinline-section-year").find(".add-new-vehicleinline-section-value").text(selectedYear);$(".add-new-vehicleinline-year-input").parents(panelSelectedClass).removeClass("add-new-vehicleinline-show-year").addClass("add-new-vehicleinline-show-make");$(".add-new-vehicleinline-section").removeClass("add-new-vehicleinline-section-active add-new-vehicleinline-section-complete");$(".add-new-vehicleinline-section-year").addClass("add-new-vehicleinline-section-complete");$(".add-new-vehicleinline-section-make").addClass("add-new-vehicleinline-section-active");handleYearSelection(years[i].NavigationData,selectedYear,years[i].RefinementValue);$(".add-new-vehicle-year-input").val("");handleAddNewVehicleFormData();}});if(isYearNotFound){handleClearYearInputTextField();$(".add-new-vehicleinline-selected-panel").find(".notification").show().addClass("notification-error").append('<p class="notification-text">'+yearNotFoundMessage+"</p>");return false;}}},error:function(){handleClearYearInputTextField();$(".add-new-vehicleinline-selected-panel").find(".notification").show().addClass("notification-error").append('<p class="notification-text">'+yearNotFoundMessage+"</p>");return false;}});return false;}});};$(".add-new-vehicleinline-year-input").on("keypress",function(e){if(e.which===13){return false;}});var addNewVehicleselect=function(){$(addNewVehicleselctlistInline).on("change",function(){handleClearVINSearch();var navigationData=$(addNewVehicleInline).find(".add-new-vehicleinline-panel-selected-link").attr("data-navigation");var refinementValue=$(addNewVehicleInline).find(".add-new-vehicleinline-panel-selected-link").attr("data-refinement-value");var removeDivs=$(this).parent().siblings(".add-new-vehicleinline-content-grid.year");var listDiv=$(this).parents().find(".add-new-vehicleinline-year .row.flushed");var selectedYear=$(this).val();$(".add-new-vehicleinline-section-year").find(".add-new-vehicleinline-section-value").text(selectedYear);$.ajax({url:urlVehicleYears+"/"+navigationData+"?from=inline_addNewVehicleSelect",success:function(data){if(data.status=="error"){$(addNewVehicleInline).find(".vehicle-error").append("<p>"+data.errorMessageList[0]+"</p>");return false;}else{var years=JSON.parse(data.resultData).Refinements;if(years.length==0){$(addNewVehicleInline).find(".vehicle-error").append("<p>"+data.errorMessageList[0]+"</p>");return false;}$.each(years,function(i,item){if(years[i].RefinementText===selectedYear){$(".add-new-vehicleinline-year-input").parents(panelSelectedClass).removeClass("add-new-vehicleinline-show-year").addClass("add-new-vehicleinline-show-make");$(".add-new-vehicleinline-section").removeClass("add-new-vehicleinline-section-active add-new-vehicleinline-section-complete");$(".add-new-vehicleinline-section-year").addClass("add-new-vehicleinline-section-complete");$(".add-new-vehicleinline-section-make").addClass("add-new-vehicleinline-section-active");handleYearSelection(years[i].NavigationData,selectedYear,years[i].RefinementValue);handleAddNewVehicleFormData();}});}}});$(".add-new-vehicleinline-year-select").prop("selectedIndex",0);});};var handleModelSelection=function(navigationData,selectedModel,refinementValue){$(".add-new-vehicleinline-section-model").find(".add-new-vehicleinline-section-value").text(selectedModel).attr("data-navigation",navigationData).attr("data-refinement-value",refinementValue);};var handleClearAllVehicleSearch=function(){$(".add-new-vehicleinline-search-input").val("");$(".add-new-vehicleinline-section .add-new-vehicleinline-section-value, .add-new-vehicleinline-panel-selected-link").removeClass("disabled");$(".add-new-vehicleinline-section-year, .add-new-vehicleinline-section-make, .add-new-vehicleinline-section-model").find(".add-new-vehicleinline-section-value").text("").attr("data-refinement-value","");$(".add-new-vehicleinline-year").find(".add-new-vehicleinline-content-grid.year").remove();$(".add-new-vehicleinline-make").find(".add-new-vehicleinline-content-grid.make").remove();$(".add-new-vehicleinline-model").find(".add-new-vehicleinline-content-grid.model").remove();$(".add-new-vehicleinline-selected-panel").removeClass("add-new-vehicleinline-show-make").removeClass("add-new-vehicleinline-show-complete").addClass("add-new-vehicleinline-show-year");$(".add-new-vehicleinline-section").not(".add-new-vehicleinline-section.add-new-vehicleinline-section-year").removeClass("add-new-vehicleinline-section-active").removeClass("add-new-vehicleinline-section-complete");};var handleClearVINSearch=function(){$(".add-new-vehicleinline-search-input").removeClass("error").removeClass("success").val("");$(".add-new-vehicleinline-selected-panel").find(".notification").hide();$(".add-new-vehicleinline-search-input").next(".error-messages").find(".error-message").html("");$(".add-new-vehicleinline-year-input").val("").removeClass("error").removeClass("success");$(".add-new-vehicleinline-year-input").nextAll(".error-messages").find(".error-message").html("");};var handleClearYearInputTextField=function(){$(".add-new-vehicleinline-search-input").removeClass("error").removeClass("success").val("");$(".add-new-vehicleinline-search-input").next(".error-messages").find(".error-message").html("");$(".add-new-vehicleinline-selected-panel").find(".notification").children("p").remove();};var handleVehicleTypeChange=function(navigationData,vehicleType,refinementValue){$(".add-new-vehicleinline-panel-selected-link").text(vehicleType).attr("data-navigation",navigationData).attr("data-refinement-value",refinementValue);$(".add-new-vehicleinline-panel").removeClass("add-new-vehicleinline-panel-others").addClass("add-new-vehicleinline-panel-selected");getOtherVehicleYearsByType(vehicleType,navigationData);handleClearAddNewVehicleFormData();$(".vehicle-panel-inline #inputHiddenEndecaVehicleTypeId").val(refinementValue);$(".vehicle-panel-inline #inputHiddenVehicleTypeName").val(vehicleType);};var handleAddNewVehicleFormData=function(){var selectedVehicleType=$(".vehicle-panel-inline").find(".add-new-vehicleinline-panel-selected-link").attr("data-refinement-value");var selectedVehicleYear=$(".vehicle-panel-inline .add-new-vehicleinline-section-year").find(".add-new-vehicleinline-section-value").attr("data-refinement-value");var selectedVehicleMake=$(".vehicle-panel-inline .add-new-vehicleinline-section-make").find(".add-new-vehicleinline-section-value").attr("data-refinement-value");var selectedVehicleModel=$(".vehicle-panel-inline .add-new-vehicleinline-section-model").find(".add-new-vehicleinline-section-value").attr("data-refinement-value");var selectedVehicleTypeText=$(".vehicle-panel-inline").find(".add-new-vehicleinline-panel-selected-link").text();var selectedVehicleYearText=$(".vehicle-panel-inline .add-new-vehicleinline-section-year").find(".add-new-vehicleinline-section-value").text();var selectedVehicleMakeText=$(".vehicle-panel-inline .add-new-vehicleinline-section-make").find(".add-new-vehicleinline-section-value").text();var selectedVehicleModelText=$(".vehicle-panel-inline .add-new-vehicleinline-section-model").find(".add-new-vehicleinline-section-value").text();if(selectedVehicleType!==null&&selectedVehicleType!==""){$(addNewVehicleInline).find("#inputHiddenEndecaVehicleTypeId").val(selectedVehicleType);$(addNewVehicleInline).find("#inputHiddenVehicleTypeName").val(selectedVehicleTypeText);}if(selectedVehicleYear!==null&&selectedVehicleYear!==""){$(addNewVehicleInline).find("#inputHiddenEndecaVehicleYearId").val(selectedVehicleYear);$(addNewVehicleInline).find("#inputHiddenVehicleYearName").val(selectedVehicleYearText);}if(selectedVehicleMake!==null&&selectedVehicleMake!==""){$(addNewVehicleInline).find("#inputHiddenEndecaVehicleMakeId").val(selectedVehicleMake);$(addNewVehicleInline).find("#inputHiddenVehicleTypeMakeName").val(selectedVehicleMakeText);}if(selectedVehicleModel!==null&&selectedVehicleModel!==""){$(addNewVehicleInline).find("#inputHiddenEndecaVehicleModelId").val(selectedVehicleModel);$(addNewVehicleInline).find("#inputHiddenVehicleTypeModelName").val(selectedVehicleModelText);}};var handleClearAddNewVehicleFormData=function(){$(".vehicle-panel-inline #inputHiddenEndecaVehicleYearId").val("");$(".vehicle-panel-inline #inputHiddenVehicleYearName").val("");$(".vehicle-panel-inline #inputHiddenEndecaVehicleMakeId").val("");$(".vehicle-panel-inline #inputHiddenVehicleTypeMakeName").val("");$(".vehicle-panel-inline #inputHiddenEndecaVehicleModelId").val("");$(".vehicle-panel-inline #inputHiddenVehicleTypeModelName").val("");};var enableVehicleModalDisclamirContent=function(){$("#add-new-vehicle-make-disclaimer").css("display","block");};var disableVehicleModalDisclamirContent=function(){$("#add-new-vehicle-make-disclaimer").css("display","none");};return{init:init};};NAPA.searchVehicleInline.init();